<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (16) -->
<title>Source code</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="source: package: squidpony.squidgrid.mapping, class: WildMap, class: MixedWildMap">
<meta name="generator" content="javadoc/SourceToHTMLConverter">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
</head>
<body class="source-page">
<main role="main">
<div class="source-container">
<pre><span class="source-line-no">001</span><span id="line.1">package squidpony.squidgrid.mapping;</span>
<span class="source-line-no">002</span><span id="line.2"></span>
<span class="source-line-no">003</span><span id="line.3">import squidpony.ArrayTools;</span>
<span class="source-line-no">004</span><span id="line.4">import squidpony.FakeLanguageGen;</span>
<span class="source-line-no">005</span><span id="line.5">import squidpony.Thesaurus;</span>
<span class="source-line-no">006</span><span id="line.6">import squidpony.annotation.Beta;</span>
<span class="source-line-no">007</span><span id="line.7">import squidpony.squidgrid.Direction;</span>
<span class="source-line-no">008</span><span id="line.8">import squidpony.squidmath.BlueNoise;</span>
<span class="source-line-no">009</span><span id="line.9">import squidpony.squidmath.IRNG;</span>
<span class="source-line-no">010</span><span id="line.10">import squidpony.squidmath.IStatefulRNG;</span>
<span class="source-line-no">011</span><span id="line.11">import squidpony.squidmath.SilkRNG;</span>
<span class="source-line-no">012</span><span id="line.12"></span>
<span class="source-line-no">013</span><span id="line.13">import java.io.Serializable;</span>
<span class="source-line-no">014</span><span id="line.14">import java.util.ArrayList;</span>
<span class="source-line-no">015</span><span id="line.15"></span>
<span class="source-line-no">016</span><span id="line.16">import static squidpony.Maker.makeList;</span>
<span class="source-line-no">017</span><span id="line.17"></span>
<span class="source-line-no">018</span><span id="line.18">/**</span>
<span class="source-line-no">019</span><span id="line.19"> * A finite 2D area map for some kind of wilderness, adapting to different ecosystems by changing its output.</span>
<span class="source-line-no">020</span><span id="line.20"> * Regional maps for wilderness areas have very different requirements from mostly-artificial dungeons. This is intended</span>
<span class="source-line-no">021</span><span id="line.21"> * to work alongside {@link WorldMapGenerator} and {@link WorldMapGenerator.DetailedBiomeMapper} to produce, for</span>
<span class="source-line-no">022</span><span id="line.22"> * example, very sparse maps with an occasional cactus in a desert, or very dense maps with many trees and shrubs for a</span>
<span class="source-line-no">023</span><span id="line.23"> * forest.</span>
<span class="source-line-no">024</span><span id="line.24"> * &lt;br&gt;</span>
<span class="source-line-no">025</span><span id="line.25"> * Using this code mostly involves constructing a WildMap with a width, height, biome, and optionally a random number</span>
<span class="source-line-no">026</span><span id="line.26"> * generator, an ArrayList of floor types (as Strings) that can appear, and an ArrayList of terrain content that can</span>
<span class="source-line-no">027</span><span id="line.27"> * appear (also as Strings). Then you can call {@link #generate()}, which assigns indices into {@link #content} and</span>
<span class="source-line-no">028</span><span id="line.28"> * {@link #floors}, where an index can look up a value from {@link #contentTypes} or {@link #floorTypes}. The biome is</span>
<span class="source-line-no">029</span><span id="line.29"> * usually an index into {@link squidpony.squidgrid.mapping.WorldMapGenerator.DetailedBiomeMapper#biomeTable}, but can</span>
<span class="source-line-no">030</span><span id="line.30"> * be some other index if you don't use DetailedBiomeMapper (you would probably use a subclass then). The</span>
<span class="source-line-no">031</span><span id="line.31"> * {@link #contentTypes} field is an ArrayList; you can have and are encouraged to have duplicates when an object should</span>
<span class="source-line-no">032</span><span id="line.32"> * appear more often. An index of -1 in content indicates nothing of note is present there. There is also a String array</span>
<span class="source-line-no">033</span><span id="line.33"> * of {@link #floorTypes} that is not typically user-set unless you subclass WildMap yourself; it is used to look up the</span>
<span class="source-line-no">034</span><span id="line.34"> * indices in {@link #floors}. The floors are set to reasonable values for the particular biome, so a forest has "dirt"</span>
<span class="source-line-no">035</span><span id="line.35"> * and "leaves" among others, while a desert might only have "sand". Again, only the indices matter, so you could change</span>
<span class="source-line-no">036</span><span id="line.36"> * the values in {@link #floorTypes} to match names of textures in a graphical game and make lookup easier, or to a char</span>
<span class="source-line-no">037</span><span id="line.37"> * followed by the name of a color (as in SColor in the display module) for a text-based game.</span>
<span class="source-line-no">038</span><span id="line.38"> * &lt;br&gt;</span>
<span class="source-line-no">039</span><span id="line.39"> * This is marked Beta because there's still some work to be done, and the actual output will change even if the API</span>
<span class="source-line-no">040</span><span id="line.40"> * doesn't have any breaks. While the wilderness maps this produces are usable, they don't have paths or areas that a</span>
<span class="source-line-no">041</span><span id="line.41"> * character would have to find a way around (like a cliff). This is meant to be added at some point, probably in</span>
<span class="source-line-no">042</span><span id="line.42"> * conjunction with some system for connecting WildMaps.</span>
<span class="source-line-no">043</span><span id="line.43"> * &lt;br&gt;</span>
<span class="source-line-no">044</span><span id="line.44"> * Created by Tommy Ettinger on 10/16/2019.</span>
<span class="source-line-no">045</span><span id="line.45"> */</span>
<span class="source-line-no">046</span><span id="line.46">@Beta</span>
<span class="source-line-no">047</span><span id="line.47">public class WildMap implements Serializable {</span>
<span class="source-line-no">048</span><span id="line.48">    private static final long serialVersionUID = 1L;</span>
<span class="source-line-no">049</span><span id="line.49">    public final int width, height;</span>
<span class="source-line-no">050</span><span id="line.50">    public int biome;</span>
<span class="source-line-no">051</span><span id="line.51">    public IStatefulRNG rng;</span>
<span class="source-line-no">052</span><span id="line.52">    public ArrayList&lt;String&gt; contentTypes;</span>
<span class="source-line-no">053</span><span id="line.53">    public ArrayList&lt;String&gt; floorTypes;</span>
<span class="source-line-no">054</span><span id="line.54">    public final int[][] content, floors;</span>
<span class="source-line-no">055</span><span id="line.55"></span>
<span class="source-line-no">056</span><span id="line.56">    /**</span>
<span class="source-line-no">057</span><span id="line.57">     * Meant for generating large ArrayLists of Strings where an individual String may occur quite a few times.</span>
<span class="source-line-no">058</span><span id="line.58">     * The rest parameter is a vararg (it may also be an Object array) of alternating String and Integer values, where</span>
<span class="source-line-no">059</span><span id="line.59">     * an Integer is how many times to repeat the preceding String in the returned ArrayList.</span>
<span class="source-line-no">060</span><span id="line.60">     * @param rest a vararg (or Object array) of alternating String and Integer values</span>
<span class="source-line-no">061</span><span id="line.61">     * @return an ArrayList of Strings, probably with some or most of them repeated; you may want to shuffle this result</span>
<span class="source-line-no">062</span><span id="line.62">     */</span>
<span class="source-line-no">063</span><span id="line.63">    public static ArrayList&lt;String&gt; makeRepeats(Object... rest)</span>
<span class="source-line-no">064</span><span id="line.64">    {</span>
<span class="source-line-no">065</span><span id="line.65">        if(rest == null || rest.length &lt; 2)</span>
<span class="source-line-no">066</span><span id="line.66">        {</span>
<span class="source-line-no">067</span><span id="line.67">            return new ArrayList&lt;&gt;(0);</span>
<span class="source-line-no">068</span><span id="line.68">        }</span>
<span class="source-line-no">069</span><span id="line.69">        ArrayList&lt;String&gt; al = new ArrayList&lt;&gt;(rest.length);</span>
<span class="source-line-no">070</span><span id="line.70"></span>
<span class="source-line-no">071</span><span id="line.71">        for (int i = 0; i &lt; rest.length - 1; i+=2) {</span>
<span class="source-line-no">072</span><span id="line.72">            try {</span>
<span class="source-line-no">073</span><span id="line.73">                int count = (int)rest[i+1];</span>
<span class="source-line-no">074</span><span id="line.74">                String v = (String) rest[i];</span>
<span class="source-line-no">075</span><span id="line.75">                for (int j = 0; j &lt; count; j++) {</span>
<span class="source-line-no">076</span><span id="line.76">                    al.add(v);</span>
<span class="source-line-no">077</span><span id="line.77">                }</span>
<span class="source-line-no">078</span><span id="line.78">            }catch (ClassCastException ignored) {</span>
<span class="source-line-no">079</span><span id="line.79">            }</span>
<span class="source-line-no">080</span><span id="line.80">        }</span>
<span class="source-line-no">081</span><span id="line.81">        return al;</span>
<span class="source-line-no">082</span><span id="line.82">    }</span>
<span class="source-line-no">083</span><span id="line.83">    public static ArrayList&lt;String&gt; makeShuffledRepeats(IRNG rng, Object... rest) </span>
<span class="source-line-no">084</span><span id="line.84">    {</span>
<span class="source-line-no">085</span><span id="line.85">        ArrayList&lt;String&gt; al = makeRepeats(rest);</span>
<span class="source-line-no">086</span><span id="line.86">        rng.shuffleInPlace(al);</span>
<span class="source-line-no">087</span><span id="line.87">        return al;</span>
<span class="source-line-no">088</span><span id="line.88">    }</span>
<span class="source-line-no">089</span><span id="line.89">    public static ArrayList&lt;String&gt; makeVegetation(IRNG rng, int size, double monoculture, FakeLanguageGen naming)</span>
<span class="source-line-no">090</span><span id="line.90">    {</span>
<span class="source-line-no">091</span><span id="line.91">        Thesaurus t = new Thesaurus(rng);</span>
<span class="source-line-no">092</span><span id="line.92">        ArrayList&lt;String&gt; al = new ArrayList&lt;&gt;(size);</span>
<span class="source-line-no">093</span><span id="line.93">        String latest;</span>
<span class="source-line-no">094</span><span id="line.94">        for (int i = size; i &gt; 0; i--) {</span>
<span class="source-line-no">095</span><span id="line.95">            al.add(latest = t.makePlantName(naming));</span>
<span class="source-line-no">096</span><span id="line.96">            for (double j = rng.nextDouble(monoculture * 2.0 * size); j &gt;= 1 &amp;&amp; i &gt; 0; j--, i--) {</span>
<span class="source-line-no">097</span><span id="line.97">                al.add(latest);</span>
<span class="source-line-no">098</span><span id="line.98">            }</span>
<span class="source-line-no">099</span><span id="line.99">        }</span>
<span class="source-line-no">100</span><span id="line.100">        rng.shuffleInPlace(al);</span>
<span class="source-line-no">101</span><span id="line.101">        return al;</span>
<span class="source-line-no">102</span><span id="line.102">    }</span>
<span class="source-line-no">103</span><span id="line.103"></span>
<span class="source-line-no">104</span><span id="line.104">    /**</span>
<span class="source-line-no">105</span><span id="line.105">     * Gets a list of Strings that are really just the names of types of floor tile for wilderness areas.</span>
<span class="source-line-no">106</span><span id="line.106">     * @param biome an index into {@link squidpony.squidgrid.mapping.WorldMapGenerator.DetailedBiomeMapper#biomeTable}, or some other index if you don't use DetailedBiomeMapper</span>
<span class="source-line-no">107</span><span id="line.107">     * @param rng an IRNG, like {@link squidpony.squidmath.RNG} or {@link squidpony.squidmath.GWTRNG} </span>
<span class="source-line-no">108</span><span id="line.108">     * @return a shuffled ArrayList that typically contains repeats of the kinds of floor that can appear here</span>
<span class="source-line-no">109</span><span id="line.109">     */</span>
<span class="source-line-no">110</span><span id="line.110">    public static ArrayList&lt;String&gt; floorsByBiome(int biome, IRNG rng) {</span>
<span class="source-line-no">111</span><span id="line.111">        biome &amp;= 1023;</span>
<span class="source-line-no">112</span><span id="line.112">        switch (biome) {</span>
<span class="source-line-no">113</span><span id="line.113">            case 0: //Ice</span>
<span class="source-line-no">114</span><span id="line.114">            case 1:</span>
<span class="source-line-no">115</span><span id="line.115">            case 6:</span>
<span class="source-line-no">116</span><span id="line.116">            case 12:</span>
<span class="source-line-no">117</span><span id="line.117">            case 18:</span>
<span class="source-line-no">118</span><span id="line.118">            case 24:</span>
<span class="source-line-no">119</span><span id="line.119">            case 30:</span>
<span class="source-line-no">120</span><span id="line.120">            case 42:</span>
<span class="source-line-no">121</span><span id="line.121">            case 48:</span>
<span class="source-line-no">122</span><span id="line.122">                return makeShuffledRepeats(rng, "snow", 3, "ice", 1);</span>
<span class="source-line-no">123</span><span id="line.123">            case 7: //Tundra</span>
<span class="source-line-no">124</span><span id="line.124">            case 13:</span>
<span class="source-line-no">125</span><span id="line.125">            case 19:</span>
<span class="source-line-no">126</span><span id="line.126">            case 25:</span>
<span class="source-line-no">127</span><span id="line.127">                return makeShuffledRepeats(rng, "dirt", 6, "pebbles", 1, "snow", 9, "dry grass", 4);</span>
<span class="source-line-no">128</span><span id="line.128">            case 26: //BorealForest</span>
<span class="source-line-no">129</span><span id="line.129">            case 31:</span>
<span class="source-line-no">130</span><span id="line.130">            case 32:</span>
<span class="source-line-no">131</span><span id="line.131">                return makeShuffledRepeats(rng, "dirt", 3, "pebbles", 1, "snow", 11);</span>
<span class="source-line-no">132</span><span id="line.132">            case 43: //River</span>
<span class="source-line-no">133</span><span id="line.133">            case 44:</span>
<span class="source-line-no">134</span><span id="line.134">            case 45:</span>
<span class="source-line-no">135</span><span id="line.135">            case 46:</span>
<span class="source-line-no">136</span><span id="line.136">            case 47:</span>
<span class="source-line-no">137</span><span id="line.137">            case 49:</span>
<span class="source-line-no">138</span><span id="line.138">            case 50:</span>
<span class="source-line-no">139</span><span id="line.139">            case 51:</span>
<span class="source-line-no">140</span><span id="line.140">            case 52:</span>
<span class="source-line-no">141</span><span id="line.141">            case 53:</span>
<span class="source-line-no">142</span><span id="line.142">                return makeList("fresh water");</span>
<span class="source-line-no">143</span><span id="line.143">            case 54: //Ocean</span>
<span class="source-line-no">144</span><span id="line.144">            case 55:</span>
<span class="source-line-no">145</span><span id="line.145">            case 56:</span>
<span class="source-line-no">146</span><span id="line.146">            case 57:</span>
<span class="source-line-no">147</span><span id="line.147">            case 58:</span>
<span class="source-line-no">148</span><span id="line.148">            case 59:</span>
<span class="source-line-no">149</span><span id="line.149">                return makeList("salt water");</span>
<span class="source-line-no">150</span><span id="line.150">            case 3: //Desert</span>
<span class="source-line-no">151</span><span id="line.151">            case 4:</span>
<span class="source-line-no">152</span><span id="line.152">            case 5:</span>
<span class="source-line-no">153</span><span id="line.153">            case 10:</span>
<span class="source-line-no">154</span><span id="line.154">            case 11:</span>
<span class="source-line-no">155</span><span id="line.155">            case 17:</span>
<span class="source-line-no">156</span><span id="line.156">            case 38: //Beach</span>
<span class="source-line-no">157</span><span id="line.157">            case 39:</span>
<span class="source-line-no">158</span><span id="line.158">            case 40:</span>
<span class="source-line-no">159</span><span id="line.159">            case 41:</span>
<span class="source-line-no">160</span><span id="line.160">                return makeList("sand");</span>
<span class="source-line-no">161</span><span id="line.161">            case 2: //Grassland</span>
<span class="source-line-no">162</span><span id="line.162">            case 8:</span>
<span class="source-line-no">163</span><span id="line.163">            case 9:</span>
<span class="source-line-no">164</span><span id="line.164">                return makeShuffledRepeats(rng, "dirt", 8, "dry grass", 13, "grass", 2);</span>
<span class="source-line-no">165</span><span id="line.165">            case 14: //Woodland</span>
<span class="source-line-no">166</span><span id="line.166">            case 15:</span>
<span class="source-line-no">167</span><span id="line.167">                return makeShuffledRepeats(rng, "dirt", 11, "leaves", 3, "dry grass", 8);</span>
<span class="source-line-no">168</span><span id="line.168">            case 16: //Savanna</span>
<span class="source-line-no">169</span><span id="line.169">            case 22:</span>
<span class="source-line-no">170</span><span id="line.170">            case 23:</span>
<span class="source-line-no">171</span><span id="line.171">            case 29:</span>
<span class="source-line-no">172</span><span id="line.172">                return makeShuffledRepeats(rng, "dirt", 4, "dry grass", 17);</span>
<span class="source-line-no">173</span><span id="line.173">            case 20: //SeasonalForest</span>
<span class="source-line-no">174</span><span id="line.174">            case 21:</span>
<span class="source-line-no">175</span><span id="line.175">                return makeShuffledRepeats(rng, "dirt", 9, "leaves", 6, "grass", 14);</span>
<span class="source-line-no">176</span><span id="line.176">            case 27: //TemperateRainforest</span>
<span class="source-line-no">177</span><span id="line.177">            case 33:</span>
<span class="source-line-no">178</span><span id="line.178">                return makeShuffledRepeats(rng, "mud", 3, "leaves", 8, "grass", 10, "moss", 5);</span>
<span class="source-line-no">179</span><span id="line.179">            case 28: //TropicalRainforest</span>
<span class="source-line-no">180</span><span id="line.180">            case 34:</span>
<span class="source-line-no">181</span><span id="line.181">            case 35:</span>
<span class="source-line-no">182</span><span id="line.182">                return makeShuffledRepeats(rng, "mud", 7, "leaves", 6, "grass", 4, "moss", 11);</span>
<span class="source-line-no">183</span><span id="line.183">            case 36: // Rocky</span>
<span class="source-line-no">184</span><span id="line.184">            case 37:</span>
<span class="source-line-no">185</span><span id="line.185">                return makeShuffledRepeats(rng, "pebbles", 5, "rubble", 1);</span>
<span class="source-line-no">186</span><span id="line.186">            default:</span>
<span class="source-line-no">187</span><span id="line.187">                return makeList("empty space");</span>
<span class="source-line-no">188</span><span id="line.188">        }</span>
<span class="source-line-no">189</span><span id="line.189">    }</span>
<span class="source-line-no">190</span><span id="line.190">    /**</span>
<span class="source-line-no">191</span><span id="line.191">     * Gets a list of Strings that are really just the names of types of path tile for wilderness areas.</span>
<span class="source-line-no">192</span><span id="line.192">     * Not currently used.</span>
<span class="source-line-no">193</span><span id="line.193">     * @param biome an index into {@link squidpony.squidgrid.mapping.WorldMapGenerator.DetailedBiomeMapper#biomeTable}, or some other index if you don't use DetailedBiomeMapper</span>
<span class="source-line-no">194</span><span id="line.194">     * @return an ArrayList that typically contains just the one or few types of path that can appear here</span>
<span class="source-line-no">195</span><span id="line.195">     */</span>
<span class="source-line-no">196</span><span id="line.196">    public static ArrayList&lt;String&gt; pathsByBiome(int biome) {</span>
<span class="source-line-no">197</span><span id="line.197">        biome &amp;= 1023;</span>
<span class="source-line-no">198</span><span id="line.198">        switch (biome) {</span>
<span class="source-line-no">199</span><span id="line.199">            case 0: //Ice</span>
<span class="source-line-no">200</span><span id="line.200">            case 1:</span>
<span class="source-line-no">201</span><span id="line.201">            case 6:</span>
<span class="source-line-no">202</span><span id="line.202">            case 12:</span>
<span class="source-line-no">203</span><span id="line.203">            case 18:</span>
<span class="source-line-no">204</span><span id="line.204">            case 24:</span>
<span class="source-line-no">205</span><span id="line.205">            case 30:</span>
<span class="source-line-no">206</span><span id="line.206">            case 42:</span>
<span class="source-line-no">207</span><span id="line.207">            case 48:</span>
<span class="source-line-no">208</span><span id="line.208">                return makeList("snow path");</span>
<span class="source-line-no">209</span><span id="line.209">            case 7: //Tundra</span>
<span class="source-line-no">210</span><span id="line.210">            case 13:</span>
<span class="source-line-no">211</span><span id="line.211">            case 19:</span>
<span class="source-line-no">212</span><span id="line.212">            case 25: </span>
<span class="source-line-no">213</span><span id="line.213">            case 26: //BorealForest</span>
<span class="source-line-no">214</span><span id="line.214">            case 31:</span>
<span class="source-line-no">215</span><span id="line.215">            case 32:</span>
<span class="source-line-no">216</span><span id="line.216">                return makeList("snow path", "dirt path");</span>
<span class="source-line-no">217</span><span id="line.217">//            case 43: //River</span>
<span class="source-line-no">218</span><span id="line.218">//            case 44:</span>
<span class="source-line-no">219</span><span id="line.219">//            case 45:</span>
<span class="source-line-no">220</span><span id="line.220">//            case 46:</span>
<span class="source-line-no">221</span><span id="line.221">//            case 47:</span>
<span class="source-line-no">222</span><span id="line.222">//            case 49:</span>
<span class="source-line-no">223</span><span id="line.223">//            case 50:</span>
<span class="source-line-no">224</span><span id="line.224">//            case 51:</span>
<span class="source-line-no">225</span><span id="line.225">//            case 52:</span>
<span class="source-line-no">226</span><span id="line.226">//            case 53:</span>
<span class="source-line-no">227</span><span id="line.227">//            case 54: //Ocean</span>
<span class="source-line-no">228</span><span id="line.228">//            case 55:</span>
<span class="source-line-no">229</span><span id="line.229">//            case 56:</span>
<span class="source-line-no">230</span><span id="line.230">//            case 57:</span>
<span class="source-line-no">231</span><span id="line.231">//            case 58:</span>
<span class="source-line-no">232</span><span id="line.232">//            case 59:</span>
<span class="source-line-no">233</span><span id="line.233">//                return makeList("wooden bridge");</span>
<span class="source-line-no">234</span><span id="line.234">            case 3: //Desert</span>
<span class="source-line-no">235</span><span id="line.235">            case 4:</span>
<span class="source-line-no">236</span><span id="line.236">            case 5:</span>
<span class="source-line-no">237</span><span id="line.237">            case 10:</span>
<span class="source-line-no">238</span><span id="line.238">            case 11:</span>
<span class="source-line-no">239</span><span id="line.239">            case 17:</span>
<span class="source-line-no">240</span><span id="line.240">            case 38: //Beach</span>
<span class="source-line-no">241</span><span id="line.241">            case 39:</span>
<span class="source-line-no">242</span><span id="line.242">            case 40:</span>
<span class="source-line-no">243</span><span id="line.243">            case 41:</span>
<span class="source-line-no">244</span><span id="line.244">                return makeList("sand path");</span>
<span class="source-line-no">245</span><span id="line.245">            case 2: //Grassland</span>
<span class="source-line-no">246</span><span id="line.246">            case 8:</span>
<span class="source-line-no">247</span><span id="line.247">            case 9:</span>
<span class="source-line-no">248</span><span id="line.248">            case 14: //Woodland</span>
<span class="source-line-no">249</span><span id="line.249">            case 15:</span>
<span class="source-line-no">250</span><span id="line.250">            case 16: //Savanna</span>
<span class="source-line-no">251</span><span id="line.251">            case 22:</span>
<span class="source-line-no">252</span><span id="line.252">            case 23:</span>
<span class="source-line-no">253</span><span id="line.253">            case 29:</span>
<span class="source-line-no">254</span><span id="line.254">                return makeList("dirt path");</span>
<span class="source-line-no">255</span><span id="line.255">            case 20: //SeasonalForest</span>
<span class="source-line-no">256</span><span id="line.256">            case 21:</span>
<span class="source-line-no">257</span><span id="line.257">                return makeList("dirt path", "grass path");</span>
<span class="source-line-no">258</span><span id="line.258">            case 27: //TemperateRainforest</span>
<span class="source-line-no">259</span><span id="line.259">            case 33:</span>
<span class="source-line-no">260</span><span id="line.260">            case 28: //TropicalRainforest</span>
<span class="source-line-no">261</span><span id="line.261">            case 34:</span>
<span class="source-line-no">262</span><span id="line.262">            case 35:</span>
<span class="source-line-no">263</span><span id="line.263">                return makeList("grass path");</span>
<span class="source-line-no">264</span><span id="line.264">            case 36: // Rocky</span>
<span class="source-line-no">265</span><span id="line.265">            case 37:</span>
<span class="source-line-no">266</span><span id="line.266">                return makeList("stone path");</span>
<span class="source-line-no">267</span><span id="line.267">            default:</span>
<span class="source-line-no">268</span><span id="line.268">                return makeList("wooden bridge");</span>
<span class="source-line-no">269</span><span id="line.269"></span>
<span class="source-line-no">270</span><span id="line.270">        }</span>
<span class="source-line-no">271</span><span id="line.271">    }</span>
<span class="source-line-no">272</span><span id="line.272">    /**</span>
<span class="source-line-no">273</span><span id="line.273">     * Gets a list of Strings that are really just the names of types of terrain feature for wilderness areas.</span>
<span class="source-line-no">274</span><span id="line.274">     * @param biome an index into {@link squidpony.squidgrid.mapping.WorldMapGenerator.DetailedBiomeMapper#biomeTable}, or some other index if you don't use DetailedBiomeMapper</span>
<span class="source-line-no">275</span><span id="line.275">     * @param rng an IRNG, like {@link squidpony.squidmath.RNG} or {@link squidpony.squidmath.GWTRNG}</span>
<span class="source-line-no">276</span><span id="line.276">     * @return a shuffled ArrayList that typically contains repeats of the kinds of terrain feature that can appear here</span>
<span class="source-line-no">277</span><span id="line.277">     */</span>
<span class="source-line-no">278</span><span id="line.278">    public static ArrayList&lt;String&gt; contentByBiome(int biome, IRNG rng) {</span>
<span class="source-line-no">279</span><span id="line.279">        biome &amp;= 1023;</span>
<span class="source-line-no">280</span><span id="line.280">        switch (biome) {</span>
<span class="source-line-no">281</span><span id="line.281">            case 0: //Ice</span>
<span class="source-line-no">282</span><span id="line.282">            case 1:</span>
<span class="source-line-no">283</span><span id="line.283">            case 6:</span>
<span class="source-line-no">284</span><span id="line.284">            case 12:</span>
<span class="source-line-no">285</span><span id="line.285">            case 18:</span>
<span class="source-line-no">286</span><span id="line.286">            case 24:</span>
<span class="source-line-no">287</span><span id="line.287">            case 30:</span>
<span class="source-line-no">288</span><span id="line.288">            case 42:</span>
<span class="source-line-no">289</span><span id="line.289">            case 48:</span>
<span class="source-line-no">290</span><span id="line.290">                return makeShuffledRepeats(rng, "snow mound", 5, "icy divot", 2, "powder snowdrift", 5);</span>
<span class="source-line-no">291</span><span id="line.291">            case 7: //Tundra</span>
<span class="source-line-no">292</span><span id="line.292">            case 13:</span>
<span class="source-line-no">293</span><span id="line.293">            case 19:</span>
<span class="source-line-no">294</span><span id="line.294">            case 25:</span>
<span class="source-line-no">295</span><span id="line.295">                return makeShuffledRepeats(rng, "snow mound", 4, "hillock", 6, "animal burrow", 5, "small bush 1", 2);</span>
<span class="source-line-no">296</span><span id="line.296">            case 26: //BorealForest</span>
<span class="source-line-no">297</span><span id="line.297">            case 31:</span>
<span class="source-line-no">298</span><span id="line.298">            case 32:</span>
<span class="source-line-no">299</span><span id="line.299">                return makeShuffledRepeats(rng, "snow mound", 3, "small bush 1", 5, "large bush 1", 3, "evergreen tree 1", 17, "evergreen tree 2", 12);</span>
<span class="source-line-no">300</span><span id="line.300">//                case 43: //River</span>
<span class="source-line-no">301</span><span id="line.301">//                case 44:</span>
<span class="source-line-no">302</span><span id="line.302">//                case 45:</span>
<span class="source-line-no">303</span><span id="line.303">//                case 46:</span>
<span class="source-line-no">304</span><span id="line.304">//                case 47:</span>
<span class="source-line-no">305</span><span id="line.305">//                case 49:</span>
<span class="source-line-no">306</span><span id="line.306">//                case 50:</span>
<span class="source-line-no">307</span><span id="line.307">//                case 51:</span>
<span class="source-line-no">308</span><span id="line.308">//                case 52:</span>
<span class="source-line-no">309</span><span id="line.309">//                case 53:</span>
<span class="source-line-no">310</span><span id="line.310">//                case 54: //Ocean</span>
<span class="source-line-no">311</span><span id="line.311">//                case 55:</span>
<span class="source-line-no">312</span><span id="line.312">//                case 56:</span>
<span class="source-line-no">313</span><span id="line.313">//                case 57:</span>
<span class="source-line-no">314</span><span id="line.314">//                case 58:</span>
<span class="source-line-no">315</span><span id="line.315">//                case 59:</span>
<span class="source-line-no">316</span><span id="line.316">//                    return new ArrayList&lt;&gt;(0);</span>
<span class="source-line-no">317</span><span id="line.317">            case 3: //Desert</span>
<span class="source-line-no">318</span><span id="line.318">            case 4:</span>
<span class="source-line-no">319</span><span id="line.319">            case 5:</span>
<span class="source-line-no">320</span><span id="line.320">            case 10:</span>
<span class="source-line-no">321</span><span id="line.321">            case 11:</span>
<span class="source-line-no">322</span><span id="line.322">            case 17:</span>
<span class="source-line-no">323</span><span id="line.323">                return makeShuffledRepeats(rng, "small cactus 1", 2, "large cactus 1", 2, "succulent 1", 1, "animal burrow", 2);</span>
<span class="source-line-no">324</span><span id="line.324">            case 38: //Beach</span>
<span class="source-line-no">325</span><span id="line.325">            case 39:</span>
<span class="source-line-no">326</span><span id="line.326">            case 40:</span>
<span class="source-line-no">327</span><span id="line.327">            case 41:</span>
<span class="source-line-no">328</span><span id="line.328">                return makeShuffledRepeats(rng, "seashell 1", 3, "seashell 2", 3, "seashell 3", 3, "seashell 4", 3, "driftwood", 5, "boulder", 3);</span>
<span class="source-line-no">329</span><span id="line.329">            case 2: //Grassland</span>
<span class="source-line-no">330</span><span id="line.330">            case 8:</span>
<span class="source-line-no">331</span><span id="line.331">            case 9:</span>
<span class="source-line-no">332</span><span id="line.332">                return makeShuffledRepeats(rng, "deciduous tree 1", 3, "small bush 1", 5, "small bush 2", 4, "large bush 1", 5, "animal burrow", 8, "hillock", 4);</span>
<span class="source-line-no">333</span><span id="line.333">            case 14: //Woodland</span>
<span class="source-line-no">334</span><span id="line.334">            case 15:</span>
<span class="source-line-no">335</span><span id="line.335">                return makeShuffledRepeats(rng, "deciduous tree 1", 12, "deciduous tree 2", 9, "deciduous tree 3", 6, "small bush 1", 4, "small bush 2", 3, "animal burrow", 3);</span>
<span class="source-line-no">336</span><span id="line.336">            case 16: //Savanna</span>
<span class="source-line-no">337</span><span id="line.337">            case 22:</span>
<span class="source-line-no">338</span><span id="line.338">            case 23:</span>
<span class="source-line-no">339</span><span id="line.339">            case 29:</span>
<span class="source-line-no">340</span><span id="line.340">                return makeShuffledRepeats(rng, "small bush 1", 8, "small bush 2", 5, "large bush 1", 2, "animal burrow", 3, "hillock", 6);</span>
<span class="source-line-no">341</span><span id="line.341">            case 20: //SeasonalForest</span>
<span class="source-line-no">342</span><span id="line.342">            case 21:</span>
<span class="source-line-no">343</span><span id="line.343">                return makeShuffledRepeats(rng, "deciduous tree 1", 15, "deciduous tree 2", 13, "deciduous tree 3", 12, "small bush 1", 3, "large bush 1", 5, "large bush 2", 4, "animal burrow", 3);</span>
<span class="source-line-no">344</span><span id="line.344">            case 27: //TemperateRainforest</span>
<span class="source-line-no">345</span><span id="line.345">            case 33:</span>
<span class="source-line-no">346</span><span id="line.346">                return makeShuffledRepeats(rng, "tropical tree 1", 6, "tropical tree 2", 5, "deciduous tree 1", 13, "deciduous tree 2", 12, "small bush 1", 8, "large bush 1", 7, "large bush 2", 7, "large bush 3", 3, "animal burrow", 3);</span>
<span class="source-line-no">347</span><span id="line.347">            case 28: //TropicalRainforest</span>
<span class="source-line-no">348</span><span id="line.348">            case 34:</span>
<span class="source-line-no">349</span><span id="line.349">            case 35:</span>
<span class="source-line-no">350</span><span id="line.350">                return makeShuffledRepeats(rng, "tropical tree 1", 12, "tropical tree 2", 11, "tropical tree 3", 10, "tropical tree 4", 9, "small bush 1", 6, "small bush 2", 5, "large bush 1", 6, "large bush 2", 5, "large bush 3", 3, "animal burrow", 9, "boulder", 1);</span>
<span class="source-line-no">351</span><span id="line.351">            case 36: // Rocky</span>
<span class="source-line-no">352</span><span id="line.352">            case 37:</span>
<span class="source-line-no">353</span><span id="line.353">                return makeShuffledRepeats(rng, "seashell 1", 3, "seashell 2", 2, "seashell 3", 2, "driftwood", 6, "boulder", 9);</span>
<span class="source-line-no">354</span><span id="line.354">            default:</span>
<span class="source-line-no">355</span><span id="line.355">                return new ArrayList&lt;&gt;(0);</span>
<span class="source-line-no">356</span><span id="line.356">        }</span>
<span class="source-line-no">357</span><span id="line.357">    }</span>
<span class="source-line-no">358</span><span id="line.358">//                //COLDEST //COLDER        //COLD            //HOT                  //HOTTER              //HOTTEST</span>
<span class="source-line-no">359</span><span id="line.359">//                "Ice",    "Ice",          "Grassland",      "Desert",              "Desert",             "Desert",             //DRYEST</span>
<span class="source-line-no">360</span><span id="line.360">//                "Ice",    "Tundra",       "Grassland",      "Grassland",           "Desert",             "Desert",             //DRYER</span>
<span class="source-line-no">361</span><span id="line.361">//                "Ice",    "Tundra",       "Woodland",       "Woodland",            "Savanna",            "Desert",             //DRY</span>
<span class="source-line-no">362</span><span id="line.362">//                "Ice",    "Tundra",       "SeasonalForest", "SeasonalForest",      "Savanna",            "Savanna",            //WET</span>
<span class="source-line-no">363</span><span id="line.363">//                "Ice",    "Tundra",       "BorealForest",   "TemperateRainforest", "TropicalRainforest", "Savanna",            //WETTER</span>
<span class="source-line-no">364</span><span id="line.364">//                "Ice",    "BorealForest", "BorealForest",   "TemperateRainforest", "TropicalRainforest", "TropicalRainforest", //WETTEST</span>
<span class="source-line-no">365</span><span id="line.365">//                "Rocky",  "Rocky",        "Beach",          "Beach",               "Beach",              "Beach",              //COASTS</span>
<span class="source-line-no">366</span><span id="line.366">//                "Ice",    "River",        "River",          "River",               "River",              "River",              //RIVERS</span>
<span class="source-line-no">367</span><span id="line.367">//                "Ice",    "River",        "River",          "River",               "River",              "River",              //LAKES</span>
<span class="source-line-no">368</span><span id="line.368">//                "Ocean",  "Ocean",        "Ocean",          "Ocean",               "Ocean",              "Ocean",              //OCEAN</span>
<span class="source-line-no">369</span><span id="line.369">//                "Empty",                                                                                                       //SPACE</span>
<span class="source-line-no">370</span><span id="line.370">    </span>
<span class="source-line-no">371</span><span id="line.371">    public WildMap()</span>
<span class="source-line-no">372</span><span id="line.372">    {</span>
<span class="source-line-no">373</span><span id="line.373">        this(128, 128, 21);</span>
<span class="source-line-no">374</span><span id="line.374">    }</span>
<span class="source-line-no">375</span><span id="line.375">    public WildMap(int width, int height, int biome)</span>
<span class="source-line-no">376</span><span id="line.376">    {</span>
<span class="source-line-no">377</span><span id="line.377">        this(width, height, biome, new SilkRNG());</span>
<span class="source-line-no">378</span><span id="line.378">    }</span>
<span class="source-line-no">379</span><span id="line.379">    public WildMap(int width, int height, int biome, int seedA, int seedB)</span>
<span class="source-line-no">380</span><span id="line.380">    {</span>
<span class="source-line-no">381</span><span id="line.381">        this(width, height, biome, new SilkRNG(seedA, seedB));</span>
<span class="source-line-no">382</span><span id="line.382">    }</span>
<span class="source-line-no">383</span><span id="line.383">    public WildMap(int width, int height, int biome, IStatefulRNG rng)</span>
<span class="source-line-no">384</span><span id="line.384">    {</span>
<span class="source-line-no">385</span><span id="line.385">        this(width, height, biome, rng, floorsByBiome(biome, rng), contentByBiome(biome, rng));</span>
<span class="source-line-no">386</span><span id="line.386">    }</span>
<span class="source-line-no">387</span><span id="line.387">    public WildMap(int width, int height, int biome, IStatefulRNG rng, ArrayList&lt;String&gt; contentTypes)</span>
<span class="source-line-no">388</span><span id="line.388">    {</span>
<span class="source-line-no">389</span><span id="line.389">        this(width, height, biome, rng, floorsByBiome(biome, rng), contentTypes);</span>
<span class="source-line-no">390</span><span id="line.390">    }</span>
<span class="source-line-no">391</span><span id="line.391">    public WildMap(int width, int height, int biome, IStatefulRNG rng, ArrayList&lt;String&gt; floorTypes, ArrayList&lt;String&gt; contentTypes)</span>
<span class="source-line-no">392</span><span id="line.392">    {</span>
<span class="source-line-no">393</span><span id="line.393">        this.width = width;</span>
<span class="source-line-no">394</span><span id="line.394">        this.height = height;</span>
<span class="source-line-no">395</span><span id="line.395">        this.biome = biome;</span>
<span class="source-line-no">396</span><span id="line.396">        this.rng = rng;</span>
<span class="source-line-no">397</span><span id="line.397">        content = ArrayTools.fill(-1, width, height);</span>
<span class="source-line-no">398</span><span id="line.398">        floors = new int[width][height];</span>
<span class="source-line-no">399</span><span id="line.399">        this.floorTypes = floorTypes;</span>
<span class="source-line-no">400</span><span id="line.400">        this.contentTypes = contentTypes;</span>
<span class="source-line-no">401</span><span id="line.401">    }</span>
<span class="source-line-no">402</span><span id="line.402"></span>
<span class="source-line-no">403</span><span id="line.403">    /**</span>
<span class="source-line-no">404</span><span id="line.404">     * Produces a map by filling the {@link #floors} 2D array with indices into {@link #floorTypes}, and similarly</span>
<span class="source-line-no">405</span><span id="line.405">     * filling the {@link #content} 2D array with indices into {@link #contentTypes}. You only need to call this method</span>
<span class="source-line-no">406</span><span id="line.406">     * when you first generate a map with the specific parameters you want, such as biome, and later if you want another</span>
<span class="source-line-no">407</span><span id="line.407">     * map with the same parameters.</span>
<span class="source-line-no">408</span><span id="line.408">     * &lt;br&gt;</span>
<span class="source-line-no">409</span><span id="line.409">     * Virtually all of this method is a wrapper around functionality provided by {@link BlueNoise}, adjusted to fit</span>
<span class="source-line-no">410</span><span id="line.410">     * wilderness maps slightly.</span>
<span class="source-line-no">411</span><span id="line.411">     */</span>
<span class="source-line-no">412</span><span id="line.412">    public void generate() {</span>
<span class="source-line-no">413</span><span id="line.413">        ArrayTools.fill(content, -1);</span>
<span class="source-line-no">414</span><span id="line.414">        final int seed = rng.nextInt();</span>
<span class="source-line-no">415</span><span id="line.415">        final int limit = contentTypes.size(), floorLimit = floorTypes.size();</span>
<span class="source-line-no">416</span><span id="line.416">        int b;</span>
<span class="source-line-no">417</span><span id="line.417">        BlueNoise.blueSpill(floors, floorLimit, rng);</span>
<span class="source-line-no">418</span><span id="line.418">        for (int x = 0; x &lt; width; x++) {</span>
<span class="source-line-no">419</span><span id="line.419">            for (int y = 0; y &lt; height; y++) {</span>
<span class="source-line-no">420</span><span id="line.420">                if((b = BlueNoise.getSeededOmniTiling(x, y, seed) + 128) &lt; limit)</span>
<span class="source-line-no">421</span><span id="line.421">                    content[x][y] = b;</span>
<span class="source-line-no">422</span><span id="line.422">            }</span>
<span class="source-line-no">423</span><span id="line.423">        }</span>
<span class="source-line-no">424</span><span id="line.424">    }</span>
<span class="source-line-no">425</span><span id="line.425"></span>
<span class="source-line-no">426</span><span id="line.426">    /**</span>
<span class="source-line-no">427</span><span id="line.427">     * A subclass of {@link WildMap} that serves as a ragged edge between 2, 3, or 4 WildMaps in a square intersection.</span>
<span class="source-line-no">428</span><span id="line.428">     * You almost always supply 4 WildMaps to this (typically not other MixedWildMaps), one for each corner of the map,</span>
<span class="source-line-no">429</span><span id="line.429">     * and this generates an uneven border between them. Make sure to look up the indices in the {@link #content} and</span>
<span class="source-line-no">430</span><span id="line.430">     * {@link #floors} using this MixedWildMap's {@link #contentTypes} and {@link #floorTypes}, not the ones in the</span>
<span class="source-line-no">431</span><span id="line.431">     * inner WildMaps, because the indices in the MixedWildMap are different.</span>
<span class="source-line-no">432</span><span id="line.432">     */</span>
<span class="source-line-no">433</span><span id="line.433">    public static class MixedWildMap extends WildMap implements Serializable</span>
<span class="source-line-no">434</span><span id="line.434">    {</span>
<span class="source-line-no">435</span><span id="line.435">        private static final long serialVersionUID = 1L;</span>
<span class="source-line-no">436</span><span id="line.436">        public final int[][] pieceMap;</span>
<span class="source-line-no">437</span><span id="line.437">        public final WildMap[] pieces;</span>
<span class="source-line-no">438</span><span id="line.438">        protected final int[] minFloors, maxFloors, minContents, maxContents;</span>
<span class="source-line-no">439</span><span id="line.439">        </span>
<span class="source-line-no">440</span><span id="line.440">        public MixedWildMap()</span>
<span class="source-line-no">441</span><span id="line.441">        {</span>
<span class="source-line-no">442</span><span id="line.442">            this(new WildMap(), new WildMap(), new WildMap(), new WildMap(), new SilkRNG());</span>
<span class="source-line-no">443</span><span id="line.443">        }</span>
<span class="source-line-no">444</span><span id="line.444">        </span>
<span class="source-line-no">445</span><span id="line.445">        public MixedWildMap(WildMap northeast, WildMap southeast, WildMap southwest, WildMap northwest, IStatefulRNG rng)</span>
<span class="source-line-no">446</span><span id="line.446">        {</span>
<span class="source-line-no">447</span><span id="line.447">            super(northeast.width, northeast.height, northeast.biome, rng, new ArrayList&lt;&gt;(northeast.floorTypes), new ArrayList&lt;&gt;(northeast.contentTypes));</span>
<span class="source-line-no">448</span><span id="line.448">            minFloors = new int[4];</span>
<span class="source-line-no">449</span><span id="line.449">            maxFloors = new int[4];</span>
<span class="source-line-no">450</span><span id="line.450">            minContents = new int[4];</span>
<span class="source-line-no">451</span><span id="line.451">            maxContents = new int[4];</span>
<span class="source-line-no">452</span><span id="line.452">            floorTypes.addAll(southeast.floorTypes);</span>
<span class="source-line-no">453</span><span id="line.453">            floorTypes.addAll(southwest.floorTypes);</span>
<span class="source-line-no">454</span><span id="line.454">            floorTypes.addAll(northwest.floorTypes);</span>
<span class="source-line-no">455</span><span id="line.455">            contentTypes.addAll(southeast.contentTypes);</span>
<span class="source-line-no">456</span><span id="line.456">            contentTypes.addAll(southwest.contentTypes);</span>
<span class="source-line-no">457</span><span id="line.457">            contentTypes.addAll(northwest.contentTypes);</span>
<span class="source-line-no">458</span><span id="line.458">            minFloors[1]   = maxFloors[0]   = northeast.floorTypes.size();</span>
<span class="source-line-no">459</span><span id="line.459">            minContents[1] = maxContents[0] = northeast.contentTypes.size();</span>
<span class="source-line-no">460</span><span id="line.460">            minFloors[2]   = maxFloors[1]   = maxFloors[0]    + southeast.floorTypes.size();</span>
<span class="source-line-no">461</span><span id="line.461">            minContents[2] = maxContents[1] = maxContents[0]  + southeast.contentTypes.size();</span>
<span class="source-line-no">462</span><span id="line.462">            minFloors[3]   = maxFloors[2]   = maxFloors[1]    + southwest.floorTypes.size();</span>
<span class="source-line-no">463</span><span id="line.463">            minContents[3] = maxContents[2] = maxContents[1]  + southwest.contentTypes.size();</span>
<span class="source-line-no">464</span><span id="line.464">            maxFloors[3]   = maxFloors[2]    + northwest.floorTypes.size();</span>
<span class="source-line-no">465</span><span id="line.465">            maxContents[3] = maxContents[2]  + northwest.contentTypes.size();</span>
<span class="source-line-no">466</span><span id="line.466">            pieces = new WildMap[]{northeast, southeast, southwest, northwest};</span>
<span class="source-line-no">467</span><span id="line.467">            pieceMap = new int[width][height];</span>
<span class="source-line-no">468</span><span id="line.468">        }</span>
<span class="source-line-no">469</span><span id="line.469">        </span>
<span class="source-line-no">470</span><span id="line.470">        protected void preparePieceMap()</span>
<span class="source-line-no">471</span><span id="line.471">        {</span>
<span class="source-line-no">472</span><span id="line.472">            ArrayTools.fill(pieceMap, 255);</span>
<span class="source-line-no">473</span><span id="line.473">            pieceMap[width - 1][0] = 0; // northeast</span>
<span class="source-line-no">474</span><span id="line.474">            pieceMap[width - 1][height - 1] = 1; // southeast</span>
<span class="source-line-no">475</span><span id="line.475">            pieceMap[0][height - 1] = 2; // southwest</span>
<span class="source-line-no">476</span><span id="line.476">            pieceMap[0][0] = 3; //northwest</span>
<span class="source-line-no">477</span><span id="line.477">            final int spillerLimit = 4;</span>
<span class="source-line-no">478</span><span id="line.478">            final Direction[] dirs = Direction.CARDINALS;</span>
<span class="source-line-no">479</span><span id="line.479">            Direction d;</span>
<span class="source-line-no">480</span><span id="line.480">            int t, rx, ry, ctr;</span>
<span class="source-line-no">481</span><span id="line.481">            int[] ox = new int[width], oy = new int[height];</span>
<span class="source-line-no">482</span><span id="line.482">            boolean anySuccesses = false;</span>
<span class="source-line-no">483</span><span id="line.483">            do {</span>
<span class="source-line-no">484</span><span id="line.484">                ctr = 0;</span>
<span class="source-line-no">485</span><span id="line.485">                rng.randomOrdering(width, ox);</span>
<span class="source-line-no">486</span><span id="line.486">                rng.randomOrdering(height, oy);</span>
<span class="source-line-no">487</span><span id="line.487">                for (int x = 0; x &lt; width; x++) {</span>
<span class="source-line-no">488</span><span id="line.488">                    rx = ox[x];</span>
<span class="source-line-no">489</span><span id="line.489">                    for (int y = 0; y &lt; height; y++) {</span>
<span class="source-line-no">490</span><span id="line.490">                        ry = oy[y];</span>
<span class="source-line-no">491</span><span id="line.491">                        if ((t = pieceMap[rx][ry]) &lt; spillerLimit) {</span>
<span class="source-line-no">492</span><span id="line.492">                            d = dirs[rng.next(2)];</span>
<span class="source-line-no">493</span><span id="line.493">                            if (rx + d.deltaX &gt;= 0 &amp;&amp; rx + d.deltaX &lt; width &amp;&amp; ry + d.deltaY &gt;= 0 &amp;&amp; ry + d.deltaY &lt; height &amp;&amp;</span>
<span class="source-line-no">494</span><span id="line.494">                                    pieceMap[rx + d.deltaX][ry + d.deltaY] &gt;= spillerLimit) {</span>
<span class="source-line-no">495</span><span id="line.495">                                pieceMap[rx + d.deltaX][ry + d.deltaY] = t;</span>
<span class="source-line-no">496</span><span id="line.496">                                ctr++;</span>
<span class="source-line-no">497</span><span id="line.497">                            }</span>
<span class="source-line-no">498</span><span id="line.498">                            d = dirs[rng.next(2)];</span>
<span class="source-line-no">499</span><span id="line.499">                            if (rx + d.deltaX &gt;= 0 &amp;&amp; rx + d.deltaX &lt; width &amp;&amp; ry + d.deltaY &gt;= 0 &amp;&amp; ry + d.deltaY &lt; height &amp;&amp;</span>
<span class="source-line-no">500</span><span id="line.500">                                    pieceMap[rx + d.deltaX][ry + d.deltaY] &gt;= spillerLimit) {</span>
<span class="source-line-no">501</span><span id="line.501">                                pieceMap[rx + d.deltaX][ry + d.deltaY] = t;</span>
<span class="source-line-no">502</span><span id="line.502">                                ctr++;</span>
<span class="source-line-no">503</span><span id="line.503">                            }</span>
<span class="source-line-no">504</span><span id="line.504">                        }</span>
<span class="source-line-no">505</span><span id="line.505"></span>
<span class="source-line-no">506</span><span id="line.506">                    }</span>
<span class="source-line-no">507</span><span id="line.507">                }</span>
<span class="source-line-no">508</span><span id="line.508">                if(!anySuccesses &amp;&amp; ctr == 0)</span>
<span class="source-line-no">509</span><span id="line.509">                {</span>
<span class="source-line-no">510</span><span id="line.510">                    ArrayTools.fill(pieceMap, 0);</span>
<span class="source-line-no">511</span><span id="line.511">                    return;</span>
<span class="source-line-no">512</span><span id="line.512">                }</span>
<span class="source-line-no">513</span><span id="line.513">                else</span>
<span class="source-line-no">514</span><span id="line.514">                    anySuccesses = true;</span>
<span class="source-line-no">515</span><span id="line.515">            } while (ctr &gt; 0);</span>
<span class="source-line-no">516</span><span id="line.516">            do {</span>
<span class="source-line-no">517</span><span id="line.517">                ctr = 0;</span>
<span class="source-line-no">518</span><span id="line.518">                rng.randomOrdering(width, ox);</span>
<span class="source-line-no">519</span><span id="line.519">                rng.randomOrdering(height, oy);</span>
<span class="source-line-no">520</span><span id="line.520">                for (int x = 0; x &lt; width; x++) {</span>
<span class="source-line-no">521</span><span id="line.521">                    rx = ox[x];</span>
<span class="source-line-no">522</span><span id="line.522">                    for (int y = 0; y &lt; height; y++) {</span>
<span class="source-line-no">523</span><span id="line.523">                        ry = oy[y];</span>
<span class="source-line-no">524</span><span id="line.524">                        if ((t = pieceMap[rx][ry]) &lt; spillerLimit) {</span>
<span class="source-line-no">525</span><span id="line.525">                            for (int i = 0; i &lt; 4; i++) {</span>
<span class="source-line-no">526</span><span id="line.526">                                d = dirs[i];</span>
<span class="source-line-no">527</span><span id="line.527">                                if (rx + d.deltaX &gt;= 0 &amp;&amp; rx + d.deltaX &lt; width &amp;&amp; ry + d.deltaY &gt;= 0 &amp;&amp; ry + d.deltaY &lt; height &amp;&amp;</span>
<span class="source-line-no">528</span><span id="line.528">                                        pieceMap[rx + d.deltaX][ry + d.deltaY] &gt;= spillerLimit) {</span>
<span class="source-line-no">529</span><span id="line.529">                                    pieceMap[rx + d.deltaX][ry + d.deltaY] = t;</span>
<span class="source-line-no">530</span><span id="line.530">                                    ctr++;</span>
<span class="source-line-no">531</span><span id="line.531">                                }</span>
<span class="source-line-no">532</span><span id="line.532">                            }</span>
<span class="source-line-no">533</span><span id="line.533">                        }</span>
<span class="source-line-no">534</span><span id="line.534"></span>
<span class="source-line-no">535</span><span id="line.535">                    }</span>
<span class="source-line-no">536</span><span id="line.536">                }</span>
<span class="source-line-no">537</span><span id="line.537">            } while (ctr &gt; 0);</span>
<span class="source-line-no">538</span><span id="line.538"></span>
<span class="source-line-no">539</span><span id="line.539">        }</span>
<span class="source-line-no">540</span><span id="line.540"></span>
<span class="source-line-no">541</span><span id="line.541">        @Override</span>
<span class="source-line-no">542</span><span id="line.542">        public void generate() {</span>
<span class="source-line-no">543</span><span id="line.543">            ArrayTools.fill(content, -1);</span>
<span class="source-line-no">544</span><span id="line.544">            for (int i = 0; i &lt; pieces.length; i++) {</span>
<span class="source-line-no">545</span><span id="line.545">                pieces[i].generate();</span>
<span class="source-line-no">546</span><span id="line.546">            }</span>
<span class="source-line-no">547</span><span id="line.547">            preparePieceMap();</span>
<span class="source-line-no">548</span><span id="line.548">            int p, c;</span>
<span class="source-line-no">549</span><span id="line.549">            WildMap piece;</span>
<span class="source-line-no">550</span><span id="line.550">            for (int x = 0; x &lt; width; x++) {</span>
<span class="source-line-no">551</span><span id="line.551">                for (int y = 0; y &lt; height; y++) {</span>
<span class="source-line-no">552</span><span id="line.552">                    p = pieceMap[x][y];</span>
<span class="source-line-no">553</span><span id="line.553">                    piece = pieces[p];</span>
<span class="source-line-no">554</span><span id="line.554">                    floors[x][y] = piece.floors[x][y] + minFloors[p];</span>
<span class="source-line-no">555</span><span id="line.555">                    if((c = piece.content[x][y]) &gt;= 0)</span>
<span class="source-line-no">556</span><span id="line.556">                    {</span>
<span class="source-line-no">557</span><span id="line.557">                        content[x][y] = c + minContents[p];</span>
<span class="source-line-no">558</span><span id="line.558">                    }</span>
<span class="source-line-no">559</span><span id="line.559">                }</span>
<span class="source-line-no">560</span><span id="line.560">            }</span>
<span class="source-line-no">561</span><span id="line.561">        }</span>
<span class="source-line-no">562</span><span id="line.562">    }</span>
<span class="source-line-no">563</span><span id="line.563">}</span>




























































</pre>
</div>
</main>
</body>
</html>
